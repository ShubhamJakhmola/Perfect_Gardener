<!doctype html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-4WZWST3NQ8"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-4WZWST3NQ8');
  </script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Post — Perfect Gardener</title>
  <meta name="description" content="Discover modern, responsive gardening tips, advice, and best practices." />
  <meta name="robots" content="index, follow" />
  <meta name="referrer" content="no-referrer-when-downgrade" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=(), payment=()" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: https:; script-src 'self' https://cdn.jsdelivr.net https://www.googletagmanager.com https://www.google-analytics.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; frame-src https://www.youtube.com https://youtube.com; connect-src 'self' https://api.microlink.io https://api.github.com https://raw.githubusercontent.com https://www.googletagmanager.com https://www.google-analytics.com; object-src 'none'; base-uri 'self'; form-action 'self';" />

  <link rel="icon" href="/assets/images/Avtar.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/assets/css/styles.css" />
  <link rel="stylesheet" href="/assets/css/hero_style.css" />

  <style>
    html { scroll-behavior: smooth; }

    .post-wrapper {
      max-width: 820px;
      margin: 40px auto;
      padding: 0 20px;
    }

    .post-header {
      text-align: center;
      margin-bottom: 20px;
    }

    .post-cover {
      width: 100%;
      border-radius: 12px;
      border: 1px solid var(--ring);
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      margin-top: 16px;
    }

    .prose {
      line-height: 1.7;
      font-size: 1.05rem;
      margin-top: 24px;
    }

    .prose img {
      max-width: 100%;
      border-radius: 8px;
      margin: 12px 0;
    }

    .muted {
      color: gray;
      text-align: center;
      margin-top: 40px;
      font-size: 1rem;
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body>

  <!-- HEADER -->
  <header class="site-header" id="top">
    <div class="container header-inner">

      <div class="brand">
        <div class="logo-wrap">
          <img src="/assets/images/Avtar.png" alt="Perfect Gardener logo" class="logo-img">
        </div>
        <span class="logo-text">Perfect Gardener</span>
      </div>

      <button class="nav-toggle" aria-label="Toggle menu">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </button>

      <nav class="main-nav">
        <a href="/">Home</a>
        <a href="/products.html">Products</a>
        <a href="/posts/">Posts</a>
        <a href="/#youtube">YouTube</a>
        <a href="/about.html">About</a>
      </nav>

    </div>
  </header>

  <!-- MAIN POST CONTENT -->
  <main>
    <div class="post-wrapper">
      
      <div id="loading" class="muted">Loading…</div>

      <div id="postContainer" hidden>
        <div class="post-header">
          <h1 id="postTitle"></h1>
          <img id="postCover" class="post-cover" alt="Post cover" />
        </div>

        <div id="postBody" class="prose"></div>
      </div>

    </div>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="container footer-grid">

      <div class="footer-col">
        <div class="brand"><img src="/assets/images/Avtar.png" alt="logo" class="logo" width="24" height="24" /><span class="brand-name">Perfect Gardener</span></div>
        <p class="muted">Nature, flowers, plants, care — helping them grow better.</p>
      </div>

      <div class="footer-col">
        <h4>Quick Links</h4>
        <ul class="footer-list">
          <li><a href="/">Home</a></li>
          <li><a href="/#products">Products</a></li>
          <li><a href="/posts/">Posts</a></li>
          <li><a href="/about.html">About</a></li>
          <li><a href="/privacy.html">Privacy Policy</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h4>Contact</h4>
        <ul class="footer-list">
          <li>Email: progardener01@gmail.com</li>
          <li>Location: Uttarakhand, India</li>
        </ul>
        <a class="btn primary" target="_blank" rel="noopener" href="https://www.youtube.com/@perfect.gardener">Subscribe on YouTube</a>
      </div>

    </div>

    <div class="container footer-bottom center">
      <p>© <span id="year"></span> Perfect Gardener • All rights reserved.</p>
    </div>
  </footer>

  <a href="#top" class="back-to-top" aria-label="Back to top">↑</a>

  <!-- POST LOADER SCRIPT -->
  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    document.addEventListener("DOMContentLoaded", async () => {
      const params = new URLSearchParams(window.location.search);
      const slug = params.get("slug");

      const loadingEl = document.getElementById("loading");
      const postContainer = document.getElementById("postContainer");
      const postTitle = document.getElementById("postTitle");
      const postCover = document.getElementById("postCover");
      const postBody = document.getElementById("postBody");

      if (!slug) {
        loadingEl.textContent = "No post specified.";
        return;
      }

      try {
        // Load index.json (absolute path required for Netlify)
        const res = await fetch("../assets/data/index.json");
        if (!res.ok) throw new Error("Failed to load post index");

        const data = await res.json();
        const post = data.posts.find(p => p.slug === slug);

        if (!post) throw new Error("Post not found in index.json");

        // Load markdown file using absolute path
        const mdRes = await fetch(`../assets/data/${slug}.md`);
        if (!mdRes.ok) throw new Error("Markdown file not found: " + slug);

        const markdown = await mdRes.text();

        // Show post
        loadingEl.hidden = true;
        postContainer.hidden = false;

        postTitle.textContent = post.title;
        postCover.src = post.cover || "../assets/images/og-image.jpg";
        postBody.innerHTML = marked.parse(markdown);

      } catch (err) {
        console.error("Error loading post:", err);
        loadingEl.textContent = "Failed to load post. Please try again later.";
      }
    });
  </script>

</body>
</html>
